<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>用户添加</title>
<link rel="stylesheet" th:href="@{/css/bootstrap.css}" />
<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<script src="/layer/js/layer.js"></script>
</head>
<body>
	<div class="container">
		<form id="file" method="post"
			class="form-horizontal" enctype="multipart/form-data">

			<div class="form-group">
				<label for="userName" class="col-sm-2 control-label">用户名</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" name="userName"
						id="userName" placeholder="用户名">
				</div>
			</div>
			<div class="form-group">
				<label for="userPassword" class="col-sm-2 control-label">密码</label>
				<div class="col-sm-10">
					<input type="password" class="form-control" name="userPassword"
						id="userPassword" placeholder="密码">
				</div>
			</div>
			<div class="form-group">
				<label for="email" class="col-sm-2 control-label">邮箱</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" name="email" id="email"
						placeholder="邮箱">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label"></label>
				<div class="col-sm-10">
					<div th:if="${errorMsg!=null}" class="alert alert-danger"
						role="alert" th:text="${errorMsg}"></div>
				</div>
			</div>
			<div class="form-group">
				<label for="data">选择图片</label> <input type="file"
					name="srcImg">
			</div>
		</form>
	</div>
	<script type="text/javascript">
		 function uploadFiles() {
			var data = new FormData(document.getElementById("file"));
			if ("data" != typeof (data) && data != null && data != "") {
				$.ajax({
					url : '/user/add',
					type : 'POST',
					data : data,
					async : false,
					contentType : false, //不设置内容类型
					processData : false, //不处理数据
					success : function(data) {
						if(data==200){
							alert("成功")
							layer.msg(data);
							var index = parent.layer.getFrameIndex(window.name); 
							parent.layer.close(index);
						}else{
							layer.msg(data);
						}
					},
					error : function() {
						alert("图片上传失败！");
					}
				});

			} else {
				alert("选择的文件无效！请重新选择");
			}
		}
	</script>
</body>
</html>