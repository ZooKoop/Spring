<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>用户列表</title>
<link rel="stylesheet" th:href="@{/css/bootstrap.css}" />
<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<script
	src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- <script th:src="@{/js/upload.js}"></script> -->
</head>
<body>
	<div class="container">
		<h1>用户列表</h1>
		<br />
		<div class="form-group">
			<div class="col-sm-2 control-lable">
				<a href="/toAdd" class="btn btn-info">添加</a>
			</div>
			<div class="col-sm-2 control-lable">
				<a href="#	" class="btn btn-info" 
				data-toggle="modal" data-target="#imgModel">上传图片</a>
			</div>
		</div>
		<div class="width:80%">
			<table class="table table-hover">
				<thead>
					<tr>
						<th>ID</th>
						<th>UserName</th>
						<th>UserPassword</th>
						<th>Email</th>
						<th>注册时间</th>
						<th>Edit</th>
						<th>Delete</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="list:${list}">
						<td th:text="${list.id}">1pp</td>
						<td th:text="${list.userName}">1pp</td>
						<td th:text="${list.userPassword}">1pp</td>
						<td th:text="${list.email}">1pp</td>
						<td th:text="${list.regTime}">1pp</td>
						<td><a th:data-id="${list.id}"
							onclick="cz(this.getAttribute('data-id'))" data-toggle="modal"
							data-target="#myModal">Edit</a></td>
						<td><a th:href="@{/delete(id=${list.id})}"
							onclick="return confirm('确认删除该用户吗？')">Delete</a></td>
					</tr>
				</tbody>
			</table>
		</div>
		<ul class="pagination">
		    <li>
		    	<a th:if="${list.number} gt 0" th:href="@{/list(page=${list.number-1})}" >&laquo;</a>
		    </li>
		    
		    <li><a th:if="${list.number-1} ge 0" th:href="@{/list(page=${list.number-1})}" th:text="${list.number}">2</a></li>
		    <li class="active" ><a th:href="@{/list(page=${list.number})}" th:text="${list.number+1}">2222</a></li>
		    <li><a th:if="${list.number+1} <= ${list.totalPages-1}" th:href="@{/list(page=${list.number+1})}" th:text="${list.number+2}">2</a></li>
		    
		    <li><a th:text="'当前页数：'+${list.number+1}"></a></li>
		    <li><a th:text="'总页数'+${list.totalPages}"></a></li>
		    <li><a th:if="${list.number} lt ${list.totalPages-1}" th:href="@{/list(page=${list.number+1})}">&raquo;</a></li>
		</ul>
		<!-- 模态框（Modal） -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
			aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-hidden="true">&times;</button>
						<h4 class="modal-title" id="myModalLabel">编辑用户</h4>
					</div>
					<form class="form-horizontal" th:action="@{/userUpdate}">
						<div class="modal-body">
							<div class="form-group">
								<label for="userName" class="col-sm-2 control-label">用户名：</label>
								<div class="col-sm-10">
									<input type="hidden" class="form-control" id="id"
										name="id" value="">
									<input type="text" class="form-control" id="userName"
										name="userName" value="">
								</div>
							</div>
							<div class="form-group">
								<label for="inputPassword3" class="col-sm-2 control-label">密码：</label>
								<div class="col-sm-10">
									<input type="password" readonly="readonly" class="form-control"
										id="userPassword" name="userPassword" value="">
								</div>
							</div>

							<div class="form-group">
								<label for="email" class="col-sm-2 control-label">邮箱：</label>
								<div class="col-sm-10">
									<input type="email" class="form-control" id="email"
										name="email" value="">
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label"></label>
							<div class="col-sm-10">
								<div th:if="${errorMsg!=null}" class="alert alert-danger"
									role="alert" th:text="${errorMsg}"></div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default"
								data-dismiss="modal">关闭</button>
							<button type="submit" class="btn btn-primary">提交更改</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		
		<!-- 上传图片模态框 -->
		<div class="modal fade" id="imgModel" tabindex="-1" role="dialog"
			aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-hidden="true">&times;</button>
						<h4 class="modal-title" id="myModalLabel">图片上传</h4>
					</div>
					<!-- th:action="@{/imgUpload}" -->
					<form id="file" class="form-horizontal" enctype="multipart/form-data" method="post">
						<div class="modal-body">
							<div class="form-group">
								<label for="file" class="col-sm-3 control-label">选择图片：</label>
								
								<div class="col-sm-9">
									<input id="excelFile" type="file" name="uploadFile" />
									<!-- <input class="form-control" type="file" name="file" value="file" id="file"> -->
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default"
								data-dismiss="modal">关闭</button>
							<button class="btn btn-primary" onclick="uploadFiles();">上传</button>
						</div> 
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
function uploadFiles(){  
// 	var uploadFile = $('#excelFile').get(0).files[0];
	var uploadFile = new FormData($("#file")[0]);
	console.log(uploadFile);
	if("undefined" != typeof(uploadFile) && uploadFile != null && uploadFile != ""){
		$.ajax({
			url:'/upLoad',
			type:'POST',
			data:uploadFile,
			async: false,  
			cache: false, 
			contentType: false, //不设置内容类型
			processData: false, //不处理数据
			success:function(data){
				console.log(data);
				alert(data);
			},
			error:function(){
				alert("图片上传失败！");
			}
		})
	}else {
		alert("选择的文件无效！请重新选择");
	}
}   
</script>
</html>